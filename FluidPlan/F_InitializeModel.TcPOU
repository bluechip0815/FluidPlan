(*====================================================================
    FUNCTION F_InitializeModel
    Description: Automatically generated from model.json.
                 Generated on: 2023-10-27 10:00:00 UTC
====================================================================*)
FUNCTION F_InitializeModel : BOOL
VAR
END_VAR

// Clear arrays first
MEMSET(ADR(g_arElementConfigs), 0, SIZEOF(g_arElementConfigs));
MEMSET(ADR(g_arConnections), 0, SIZEOF(g_arConnections));

// --- DEFINE ELEMENTS from model.json ---

// Element 1: Supply
g_arElementConfigs[1].sName := 'Supply';
g_arElementConfigs[1].eType := E_ElementType.Supply;
g_arElementConfigs[1].fInitialPressure := 6.0000;

// Element 2: EPU
g_arElementConfigs[2].sName := 'EPU';
g_arElementConfigs[2].eType := E_ElementType.EPU;
g_arElementConfigs[2].fConnectionArea := 3.141593E-04; // 2cm diameter
g_arElementConfigs[2].stEpuParams.fTimeConstant := 1.10;
g_arElementConfigs[2].stEpuParams.fMaxDpDt := 35.00;
g_arElementConfigs[2].stEpuParams.fNaturalFrequency := 20.00;
g_arElementConfigs[2].stEpuParams.fDampingRatio := 0.70;

// Element 3: R1
g_arElementConfigs[3].sName := 'R1';
g_arElementConfigs[3].eType := E_ElementType.Pipe;
g_arElementConfigs[3].fVolume := 3.141593E-05; // 10cm length, 2cm diameter
g_arElementConfigs[3].fConnectionArea := 3.141593E-04; // 2cm diameter

// Element 4: R2
g_arElementConfigs[4].sName := 'R2';
g_arElementConfigs[4].eType := E_ElementType.Pipe;
g_arElementConfigs[4].fVolume := 3.141593E-05; // 10cm length, 2cm diameter
g_arElementConfigs[4].fConnectionArea := 3.141593E-04; // 2cm diameter

// Element 5: R3
g_arElementConfigs[5].sName := 'R3';
g_arElementConfigs[5].eType := E_ElementType.Pipe;
g_arElementConfigs[5].fVolume := 3.141593E-05; // 10cm length, 2cm diameter
g_arElementConfigs[5].fConnectionArea := 3.141593E-04; // 2cm diameter

// Element 6: V1
g_arElementConfigs[6].sName := 'V1';
g_arElementConfigs[6].eType := E_ElementType.Valve;
g_arElementConfigs[6].fConnectionArea := 3.141593E-04; // 2cm diameter

// Element 7: V2
g_arElementConfigs[7].sName := 'V2';
g_arElementConfigs[7].eType := E_ElementType.Valve;
g_arElementConfigs[7].fConnectionArea := 3.141593E-04; // 2cm diameter

// Element 8: T1
g_arElementConfigs[8].sName := 'T1';
g_arElementConfigs[8].eType := E_ElementType.Tank;
g_arElementConfigs[8].fVolume := 2.000000E-03; // 2l
g_arElementConfigs[8].fConnectionArea := 1.963495E-05; // 0.5cm diameter


// --- DEFINE CONNECTIONS from model.json ---
// Connections are defined by the indices of the elements in the g_arElementConfigs array.
g_arConnections[1].iElementA := 1; g_arConnections[1].iElementB := 3; // Supply, R1
g_arConnections[2].iElementA := 3; g_arConnections[2].iElementB := 6; // R1, V1
g_arConnections[3].iElementA := 6; g_arConnections[3].iElementB := 4; // V1, R2
g_arConnections[4].iElementA := 3; g_arConnections[4].iElementB := 2; // R1, EPU
g_arConnections[5].iElementA := 2; g_arConnections[5].iElementB := 5; // EPU, R3
g_arConnections[6].iElementA := 5; g_arConnections[6].iElementB := 7; // R3, V2
g_arConnections[7].iElementA := 7; g_arConnections[7].iElementB := 4; // V2, R2
g_arConnections[8].iElementA := 4; g_arConnections[8].iElementB := 8; // R2, T1

F_InitializeModel := TRUE;
